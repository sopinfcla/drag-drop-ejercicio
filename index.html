<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordena las palabras correctamente</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .container {
            margin-top: 20px;
        }
        .word {
            display: inline-block;
            padding: 10px;
            margin: 5px;
            background-color: lightgray;
            border: 1px solid black;
            cursor: grab;
        }
        .dropzone {
            display: inline-block;
            padding: 10px;
            margin: 5px;
            min-width: 50px;
            min-height: 30px;
            background-color: white;
            border: 2px dashed gray;
        }
        .correct {
            background-color: lightgreen;
        }
        .incorrect {
            background-color: lightcoral;
        }
        button {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h2>Ordena las palabras correctamente</h2>
    <div id="words-container" class="container"></div>
    <div id="dropzone-container" class="container"></div>

    <button onclick="verificarOrden()">Verificar</button>
    <button onclick="reiniciar()">Reiniciar</button>

    <script>
        let correctOrder = [];

        async function cargarFrases() {
            const proxy = "https://api.allorigins.win/get?url=";
            const url = "https://claretsegovia-my.sharepoint.com/:u:/g/personal/arodrigo_claretsegoviao365_educamos_com/ERWYOb5BPhRCjWsuzaxIRPQB_0yucB36EXBjgjstPyM_Kw?e=2bDAtc"; // URL de OneDrive

            try {
                let response = await fetch(proxy + encodeURIComponent(url));
                let data = await response.json();
                let frases = JSON.parse(data.contents).frases; // Extraer el contenido JSON
                return frases;
            } catch (error) {
                console.error("Error al cargar las frases:", error);
                return [];
            }
        }

        async function iniciarEjercicio() {
            let frases = await cargarFrases();
            if (frases.length > 0) {
                let fraseSeleccionada = frases[Math.floor(Math.random() * frases.length)];
                mostrarPalabras(fraseSeleccionada.palabras);
                correctOrder = fraseSeleccionada.orden_correcto;
            }
        }

        function mostrarPalabras(palabras) {
            let wordsContainer = document.getElementById("words-container");
            let dropzoneContainer = document.getElementById("dropzone-container");
            wordsContainer.innerHTML = "";
            dropzoneContainer.innerHTML = "";

            palabras.sort(() => Math.random() - 0.5); // Mezclar palabras

            palabras.forEach(word => {
                let span = document.createElement("span");
                span.classList.add("word");
                span.textContent = word;
                span.draggable = true;
                span.addEventListener("dragstart", dragStart);
                wordsContainer.appendChild(span);
                
                let dropzone = document.createElement("div");
                dropzone.classList.add("dropzone");
                dropzone.addEventListener("dragover", dragOver);
                dropzone.addEventListener("drop", drop);
                dropzoneContainer.appendChild(dropzone);
            });
        }

        function dragStart(event) {
            event.dataTransfer.setData("text", event.target.textContent);
        }

        function dragOver(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault();
            let text = event.dataTransfer.getData("text");
            if (!event.target.textContent) {
                event.target.textContent = text;
                event.target.classList.add("word");
            }
        }

        function verificarOrden() {
            let dropzones = document.querySelectorAll(".dropzone");
            let userOrder = Array.from(dropzones).map(dz => dz.textContent.trim());
            let allCorrect = true;

            dropzones.forEach((dz, index) => {
                if (userOrder[index] === correctOrder[index]) {
                    dz.classList.add("correct");
                    dz.classList.remove("incorrect");
                } else {
                    dz.classList.add("incorrect");
                    dz.classList.remove("correct");
                    allCorrect = false;
                }
            });

            if (allCorrect) {
                alert("¡Correcto! Has ordenado bien las palabras.");
            } else {
                alert("Algunas palabras están mal ordenadas. ¡Inténtalo de nuevo!");
            }
        }

        function reiniciar() {
            iniciarEjercicio();
        }

        // Iniciar ejercicio al cargar la página
        iniciarEjercicio();
    </script>

</body>
</html>

